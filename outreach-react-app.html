<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lillia Outreach Module</title>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Lillia Brand Colors */
            --peach-lightest: #F9EAE4;
            --peach-light: #FFD2BB;
            --lavender-light: #EADEFC;
            --purple-light: #D3B9F9;
            --purple-medium: #9F7BFF;
            --purple-brand: #7848FE;
            --purple-deep: #280470;
            --blue-deep: #1405D6;

            /* Neutral Colors */
            --white: #FFFFFF;
            --gray-50: #FAFAFA;
            --gray-100: #F5F5F7;
            --gray-200: #E5E5EA;
            --gray-300: #D1D1D6;
            --gray-400: #AEAEB2;
            --gray-600: #636366;
            --gray-700: #48484A;
            --gray-900: #1C1C1E;

            /* Semantic Colors */
            --success: #34C759;
            --warning: #FF9500;
            --error: #FF3B30;

            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(120, 72, 254, 0.1);
            --shadow-md: 0 4px 12px rgba(120, 72, 254, 0.15);
            --shadow-lg: 0 12px 32px rgba(120, 72, 254, 0.2);
            --shadow-xl: 0 20px 48px rgba(120, 72, 254, 0.25);
        }

        body {
            font-family: 'Lato', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, var(--lavender-light) 0%, var(--peach-lightest) 100%);
            color: var(--gray-900);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Channel-specific colors */
        .channel-voice {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
        }
        .channel-whatsapp {
            background: linear-gradient(135deg, #22C55E, #16A34A);
        }
        .channel-sms {
            background: linear-gradient(135deg, var(--purple-medium), var(--purple-brand));
        }
        .channel-email {
            background: linear-gradient(135deg, #F97316, #EA580C);
        }

        .channel-border-voice { border-left: 4px solid #3B82F6; }
        .channel-border-whatsapp { border-left: 4px solid #22C55E; }
        .channel-border-sms { border-left: 4px solid var(--purple-medium); }
        .channel-border-email { border-left: 4px solid #F97316; }

        /* Utility Classes */
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            font-family: 'Lato', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--purple-brand), var(--purple-medium));
            color: var(--white);
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--white);
            color: var(--purple-brand);
            border: 2px solid var(--gray-200);
        }

        .btn-secondary:hover {
            background: var(--lavender-light);
            border-color: var(--purple-light);
        }

        .card {
            background: var(--white);
            border-radius: 16px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-4px);
        }

        .input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--gray-200);
            border-radius: 10px;
            font-size: 15px;
            font-family: 'Lato', sans-serif;
            transition: all 0.2s;
            background: var(--white);
        }

        .input:focus {
            outline: none;
            border-color: var(--purple-brand);
            background: var(--lavender-light);
            box-shadow: 0 0 0 4px rgba(120, 72, 254, 0.1);
        }

        .badge {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .badge-active {
            background: rgba(52, 199, 89, 0.1);
            color: var(--success);
        }

        .badge-paused {
            background: rgba(255, 149, 0, 0.1);
            color: var(--warning);
        }

        .badge-draft {
            background: var(--gray-100);
            color: var(--gray-600);
        }

        .badge-ai {
            background: linear-gradient(135deg, var(--purple-brand), var(--purple-medium));
            color: var(--white);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-100);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--purple-light);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--purple-brand);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // ============================================
        // CONTEXT & STATE MANAGEMENT
        // ============================================
        const AppContext = createContext();

        const AppProvider = ({ children }) => {
            const [view, setView] = useState('list');
            const [currentAgent, setCurrentAgent] = useState(null);
            const [wizardStep, setWizardStep] = useState(0);
            const [settings, setSettings] = useState({
                hasDocumentsModule: true,
                hasJourneyTracker: true,
                retellConfigured: true
            });

            const sampleAgents = [
                {
                    id: 'ag_001',
                    name: 'Medication Reminder - Voice',
                    channel: 'voice',
                    status: 'active',
                    lastRunAt: '2 hours ago',
                    userSelection: { method: 'cohort', matchingCount: 147, userType: 'patients' },
                    knowledgeBases: { templates: ['safety', 'compliance'], custom: [] },
                    config: { tone: 'friendly' },
                    prompt: 'You are a medication reminder assistant...',
                    documentTemplateId: 'adherence',
                    trigger: { type: 'scheduled' },
                    stats: { totalExecutions: 1247, successRate: 89, avgDuration: 234 }
                },
                {
                    id: 'ag_002',
                    name: 'Onboarding Call - New Patients',
                    channel: 'voice',
                    status: 'active',
                    lastRunAt: '1 day ago',
                    userSelection: { method: 'cohort', matchingCount: 56, userType: 'patients' },
                    knowledgeBases: { templates: ['safety'], custom: [] },
                    config: { tone: 'empathetic' },
                    prompt: 'You are an onboarding specialist...',
                    documentTemplateId: 'onboarding',
                    trigger: { type: 'event' },
                    stats: { totalExecutions: 456, successRate: 94, avgDuration: 412 }
                },
                {
                    id: 'ag_003',
                    name: 'Appointment Reminder - SMS',
                    channel: 'sms',
                    status: 'paused',
                    lastRunAt: '3 days ago',
                    userSelection: { method: 'cohort', matchingCount: 892, userType: 'patients' },
                    knowledgeBases: { templates: [], custom: [] },
                    config: {},
                    prompt: 'Hi {{patient_name}}, reminder about your appointment...',
                    documentTemplateId: null,
                    trigger: { type: 'scheduled' },
                    stats: { totalExecutions: 2341, successRate: 97, avgDuration: 0 }
                },
                {
                    id: 'ag_004',
                    name: 'Weekly Check-in - WhatsApp',
                    channel: 'whatsapp',
                    status: 'draft',
                    lastRunAt: null,
                    userSelection: { method: 'cohort', matchingCount: 0, userType: 'patients' },
                    knowledgeBases: { templates: [], custom: [] },
                    config: {},
                    prompt: '',
                    documentTemplateId: null,
                    trigger: { type: 'scheduled' },
                    stats: { totalExecutions: 0, successRate: 0, avgDuration: 0 }
                }
            ];

            const [agents, setAgents] = useState(() => {
                const saved = localStorage.getItem('lillia_agents');
                return saved ? JSON.parse(saved) : sampleAgents;
            });

            useEffect(() => {
                localStorage.setItem('lillia_agents', JSON.stringify(agents));
            }, [agents]);

            const saveAgent = (agent) => {
                const existing = agents.find(a => a.id === agent.id);
                if (existing) {
                    setAgents(agents.map(a => a.id === agent.id ? { ...agent, updatedAt: new Date().toISOString() } : a));
                } else {
                    setAgents([...agents, { ...agent, createdAt: new Date().toISOString() }]);
                }
            };

            const duplicateAgent = (sourceAgent, newName, newChannel) => {
                const newAgent = {
                    ...sourceAgent,
                    id: `ag_${Math.random().toString(36).substr(2, 9)}`,
                    name: newName,
                    channel: newChannel || sourceAgent.channel,
                    status: 'draft',
                    lastRunAt: null,
                    stats: { totalExecutions: 0, successRate: 0, avgDuration: 0 }
                };
                setAgents([...agents, newAgent]);
                return newAgent;
            };

            return (
                <AppContext.Provider value={{
                    view, setView,
                    agents, saveAgent, duplicateAgent,
                    currentAgent, setCurrentAgent,
                    wizardStep, setWizardStep,
                    settings, setSettings
                }}>
                    {children}
                </AppContext.Provider>
            );
        };

        const useApp = () => useContext(AppContext);

        // ============================================
        // ICON COMPONENTS
        // ============================================
        const Icon = ({ name, className = "w-5 h-5", ...props }) => {
            const icons = {
                phone: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg>,
                message: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>,
                send: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>,
                mail: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg>,
                plus: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 4v16m8-8H4" /></svg>,
                check: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M5 13l4 4L19 7" /></svg>,
                x: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>,
                chevronRight: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M9 5l7 7-7 7" /></svg>,
                chevronLeft: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M15 19l-7-7 7-7" /></svg>,
                users: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" /></svg>,
                settings: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>,
                shield: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>,
                alert: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>,
                copy: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>,
                dots: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" /></svg>,
                search: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>,
                upload: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" /></svg>,
                file: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>,
                calendar: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>,
                zap: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>,
                lock: <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" /></svg>,
            };
            return icons[name] || null;
        };

        // ============================================
        // MAIN APP COMPONENT
        // ============================================
        const App = () => {
            const { view } = useApp();

            return (
                <div style={{ minHeight: '100vh' }}>
                    <Header />
                    {view === 'list' && <AgentListView />}
                    {view === 'wizard' && <AgentWizard />}
                </div>
            );
        };

        // ============================================
        // HEADER
        // ============================================
        const Header = () => {
            const { view, setView, setCurrentAgent, setWizardStep } = useApp();

            return (
                <header style={{
                    background: 'var(--white)',
                    borderBottom: '1px solid var(--gray-200)',
                    position: 'sticky',
                    top: 0,
                    zIndex: 50,
                    boxShadow: 'var(--shadow-sm)'
                }}>
                    <div style={{
                        maxWidth: '1600px',
                        margin: '0 auto',
                        padding: '0 32px',
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center',
                        height: '72px'
                    }}>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                            <button
                                onClick={() => {
                                    setView('list');
                                    setCurrentAgent(null);
                                    setWizardStep(0);
                                }}
                                style={{
                                    fontSize: '32px',
                                    fontWeight: '700',
                                    color: 'var(--purple-brand)',
                                    border: 'none',
                                    background: 'none',
                                    cursor: 'pointer',
                                    fontFamily: 'Lato, sans-serif',
                                    letterSpacing: '-0.5px'
                                }}
                            >
                                lillia
                            </button>
                            {view !== 'list' && (
                                <>
                                    <span style={{ color: 'var(--gray-300)', fontSize: '24px' }}>/</span>
                                    <span style={{ color: 'var(--gray-600)', fontSize: '18px', fontWeight: '600' }}>
                                        {view === 'wizard' ? 'Create Agent' : 'Agent Details'}
                                    </span>
                                </>
                            )}
                        </div>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                            <button style={{
                                padding: '10px',
                                border: 'none',
                                background: 'var(--gray-100)',
                                borderRadius: '10px',
                                cursor: 'pointer',
                                color: 'var(--gray-600)',
                                transition: 'all 0.2s'
                            }}>
                                <Icon name="settings" />
                            </button>
                        </div>
                    </div>
                </header>
            );
        };

        // ============================================
        // AGENT LIST VIEW
        // ============================================
        const AgentListView = () => {
            const { agents, setView, setCurrentAgent, setWizardStep } = useApp();
            const [searchTerm, setSearchTerm] = useState('');
            const [channelFilter, setChannelFilter] = useState('all');
            const [statusFilter, setStatusFilter] = useState('all');

            const filteredAgents = agents.filter(agent => {
                const matchesSearch = agent.name.toLowerCase().includes(searchTerm.toLowerCase());
                const matchesChannel = channelFilter === 'all' || agent.channel === channelFilter;
                const matchesStatus = statusFilter === 'all' || agent.status === statusFilter;
                return matchesSearch && matchesChannel && matchesStatus;
            });

            const handleCreateNew = () => {
                setCurrentAgent({
                    id: `ag_${Math.random().toString(36).substr(2, 9)}`,
                    name: '',
                    channel: '',
                    status: 'draft',
                    userSelection: { method: 'cohort', cohortFilters: [], userType: 'patients' },
                    knowledgeBases: { templates: [], custom: [] },
                    config: {},
                    prompt: '',
                    documentTemplateId: null,
                    trigger: { type: 'scheduled' },
                    stats: { totalExecutions: 0, successRate: 0, avgDuration: 0 }
                });
                setWizardStep(0);
                setView('wizard');
            };

            return (
                <div style={{ maxWidth: '1600px', margin: '0 auto', padding: '40px 32px' }}>
                    {/* Header */}
                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '32px' }}>
                        <div>
                            <h1 style={{ fontSize: '36px', fontWeight: '700', color: 'var(--gray-900)', marginBottom: '8px' }}>
                                Outreach Agents
                            </h1>
                            <p style={{ fontSize: '16px', color: 'var(--gray-600)' }}>
                                Manage your automated outreach campaigns
                            </p>
                        </div>
                        <button onClick={handleCreateNew} className="btn btn-primary">
                            <Icon name="plus" />
                            Create Agent
                        </button>
                    </div>

                    {/* Filters */}
                    <div className="card" style={{ padding: '24px', marginBottom: '32px' }}>
                        <div style={{ display: 'flex', gap: '16px', flexWrap: 'wrap' }}>
                            <div style={{ flex: '1', minWidth: '300px', position: 'relative' }}>
                                <Icon name="search" style={{
                                    position: 'absolute',
                                    left: '16px',
                                    top: '50%',
                                    transform: 'translateY(-50%)',
                                    color: 'var(--gray-400)',
                                    pointerEvents: 'none'
                                }} />
                                <input
                                    type="text"
                                    placeholder="Search agents..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="input"
                                    style={{ paddingLeft: '48px' }}
                                />
                            </div>
                            <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>
                                {['all', 'voice', 'whatsapp', 'sms', 'email'].map(channel => (
                                    <button
                                        key={channel}
                                        onClick={() => setChannelFilter(channel)}
                                        style={{
                                            padding: '10px 20px',
                                            borderRadius: '10px',
                                            border: '2px solid',
                                            borderColor: channelFilter === channel ? 'var(--purple-brand)' : 'var(--gray-200)',
                                            background: channelFilter === channel ? 'var(--purple-brand)' : 'var(--white)',
                                            color: channelFilter === channel ? 'var(--white)' : 'var(--gray-700)',
                                            fontWeight: '600',
                                            fontSize: '14px',
                                            cursor: 'pointer',
                                            transition: 'all 0.2s',
                                            fontFamily: 'Lato, sans-serif'
                                        }}
                                    >
                                        {channel === 'all' ? 'All' : channel.charAt(0).toUpperCase() + channel.slice(1)}
                                    </button>
                                ))}
                            </div>
                            <div style={{ display: 'flex', gap: '8px' }}>
                                {['all', 'active', 'paused', 'draft'].map(status => (
                                    <button
                                        key={status}
                                        onClick={() => setStatusFilter(status)}
                                        style={{
                                            padding: '10px 20px',
                                            borderRadius: '10px',
                                            border: '2px solid',
                                            borderColor: statusFilter === status ? 'var(--purple-brand)' : 'var(--gray-200)',
                                            background: statusFilter === status ? 'var(--purple-brand)' : 'var(--white)',
                                            color: statusFilter === status ? 'var(--white)' : 'var(--gray-700)',
                                            fontWeight: '600',
                                            fontSize: '14px',
                                            cursor: 'pointer',
                                            transition: 'all 0.2s',
                                            fontFamily: 'Lato, sans-serif'
                                        }}
                                    >
                                        {status.charAt(0).toUpperCase() + status.slice(1)}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    {/* Agent Cards */}
                    {filteredAgents.length === 0 ? (
                        <div style={{ textAlign: 'center', padding: '80px 20px' }}>
                            <div style={{
                                width: '80px',
                                height: '80px',
                                background: 'var(--gray-100)',
                                borderRadius: '20px',
                                display: 'flex',
                                alignItems: 'center',
                                justifyContent: 'center',
                                margin: '0 auto 24px',
                                color: 'var(--gray-400)'
                            }}>
                                <Icon name="users" className="w-10 h-10" />
                            </div>
                            <h3 style={{ fontSize: '24px', fontWeight: '700', color: 'var(--gray-900)', marginBottom: '12px' }}>
                                No agents found
                            </h3>
                            <p style={{ fontSize: '16px', color: 'var(--gray-600)', marginBottom: '24px' }}>
                                {searchTerm || channelFilter !== 'all' || statusFilter !== 'all'
                                    ? 'Try adjusting your filters'
                                    : 'Create your first agent to start reaching your patients'}
                            </p>
                            {!searchTerm && channelFilter === 'all' && statusFilter === 'all' && (
                                <button onClick={handleCreateNew} className="btn btn-primary">
                                    <Icon name="plus" />
                                    Create Agent
                                </button>
                            )}
                        </div>
                    ) : (
                        <div style={{
                            display: 'grid',
                            gridTemplateColumns: 'repeat(auto-fill, minmax(380px, 1fr))',
                            gap: '24px'
                        }}>
                            {filteredAgents.map(agent => (
                                <AgentCard key={agent.id} agent={agent} />
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        // ============================================
        // AGENT CARD
        // ============================================
        const AgentCard = ({ agent }) => {
            const { setView, setCurrentAgent, setWizardStep } = useApp();
            const [showMenu, setShowMenu] = useState(false);
            const [showDuplicateModal, setShowDuplicateModal] = useState(false);

            const getChannelIcon = (channel) => {
                const icons = { voice: 'phone', whatsapp: 'message', sms: 'send', email: 'mail' };
                return icons[channel];
            };

            const handleEdit = () => {
                setCurrentAgent(agent);
                setWizardStep(0);
                setView('wizard');
            };

            return (
                <>
                    <div
                        className={`card channel-border-${agent.channel}`}
                        style={{ padding: '28px', cursor: 'pointer', position: 'relative' }}
                        onClick={handleEdit}
                    >
                        <div style={{ display: 'flex', alignItems: 'flex-start', justifyContent: 'space-between', marginBottom: '20px' }}>
                            <div
                                className={`channel-${agent.channel}`}
                                style={{
                                    width: '52px',
                                    height: '52px',
                                    borderRadius: '12px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    color: 'white'
                                }}
                            >
                                <Icon name={getChannelIcon(agent.channel)} className="w-6 h-6" />
                            </div>
                            <button
                                onClick={(e) => {
                                    e.stopPropagation();
                                    setShowMenu(!showMenu);
                                }}
                                style={{
                                    padding: '8px',
                                    border: 'none',
                                    background: 'var(--gray-100)',
                                    borderRadius: '8px',
                                    cursor: 'pointer',
                                    color: 'var(--gray-600)',
                                    transition: 'all 0.2s'
                                }}
                            >
                                <Icon name="dots" />
                            </button>
                        </div>

                        <h3 style={{ fontSize: '20px', fontWeight: '700', color: 'var(--gray-900)', marginBottom: '8px' }}>
                            {agent.name}
                        </h3>

                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '16px' }}>
                            <span className={`badge badge-${agent.status}`}>
                                {agent.status.toUpperCase()}
                            </span>
                            <span style={{ fontSize: '14px', color: 'var(--gray-600)' }}>
                                {agent.lastRunAt ? `Last run: ${agent.lastRunAt}` : 'Never run'}
                            </span>
                        </div>

                        <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '20px' }}>
                            <Icon name="users" className="w-4 h-4" style={{ color: 'var(--gray-600)' }} />
                            <span style={{ fontSize: '14px', color: 'var(--gray-600)', fontWeight: '500' }}>
                                {agent.userSelection?.matchingCount || 0} users
                            </span>
                        </div>

                        {agent.status !== 'draft' && (
                            <div style={{
                                display: 'grid',
                                gridTemplateColumns: 'repeat(3, 1fr)',
                                gap: '16px',
                                paddingTop: '20px',
                                borderTop: '1px solid var(--gray-100)'
                            }}>
                                <div>
                                    <div style={{ fontSize: '24px', fontWeight: '700', color: 'var(--purple-brand)' }}>
                                        {agent.stats.totalExecutions}
                                    </div>
                                    <div style={{ fontSize: '11px', color: 'var(--gray-600)', fontWeight: '600' }}>
                                        Total Runs
                                    </div>
                                </div>
                                <div>
                                    <div style={{ fontSize: '24px', fontWeight: '700', color: 'var(--success)' }}>
                                        {agent.stats.successRate}%
                                    </div>
                                    <div style={{ fontSize: '11px', color: 'var(--gray-600)', fontWeight: '600' }}>
                                        Success
                                    </div>
                                </div>
                                <div>
                                    <div style={{ fontSize: '24px', fontWeight: '700', color: 'var(--purple-medium)' }}>
                                        {agent.stats.avgDuration}s
                                    </div>
                                    <div style={{ fontSize: '11px', color: 'var(--gray-600)', fontWeight: '600' }}>
                                        Avg Time
                                    </div>
                                </div>
                            </div>
                        )}

                        {showMenu && (
                            <div style={{
                                position: 'absolute',
                                top: '70px',
                                right: '28px',
                                background: 'var(--white)',
                                borderRadius: '12px',
                                boxShadow: 'var(--shadow-lg)',
                                border: '1px solid var(--gray-200)',
                                zIndex: 10,
                                minWidth: '180px'
                            }}>
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        handleEdit();
                                        setShowMenu(false);
                                    }}
                                    style={{
                                        width: '100%',
                                        textAlign: 'left',
                                        padding: '12px 16px',
                                        border: 'none',
                                        background: 'none',
                                        cursor: 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: 'var(--gray-900)',
                                        borderRadius: '12px 12px 0 0',
                                        transition: 'all 0.2s',
                                        fontFamily: 'Lato, sans-serif'
                                    }}
                                    onMouseEnter={(e) => e.target.style.background = 'var(--gray-50)'}
                                    onMouseLeave={(e) => e.target.style.background = 'none'}
                                >
                                    Edit
                                </button>
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        setShowDuplicateModal(true);
                                        setShowMenu(false);
                                    }}
                                    style={{
                                        width: '100%',
                                        textAlign: 'left',
                                        padding: '12px 16px',
                                        border: 'none',
                                        background: 'none',
                                        cursor: 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: 'var(--gray-900)',
                                        transition: 'all 0.2s',
                                        fontFamily: 'Lato, sans-serif'
                                    }}
                                    onMouseEnter={(e) => e.target.style.background = 'var(--gray-50)'}
                                    onMouseLeave={(e) => e.target.style.background = 'none'}
                                >
                                    Duplicate
                                </button>
                                <button
                                    style={{
                                        width: '100%',
                                        textAlign: 'left',
                                        padding: '12px 16px',
                                        border: 'none',
                                        background: 'none',
                                        cursor: 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: 'var(--gray-900)',
                                        transition: 'all 0.2s',
                                        fontFamily: 'Lato, sans-serif'
                                    }}
                                    onMouseEnter={(e) => e.target.style.background = 'var(--gray-50)'}
                                    onMouseLeave={(e) => e.target.style.background = 'none'}
                                >
                                    {agent.status === 'active' ? 'Pause' : 'Resume'}
                                </button>
                                <button
                                    style={{
                                        width: '100%',
                                        textAlign: 'left',
                                        padding: '12px 16px',
                                        border: 'none',
                                        background: 'none',
                                        cursor: 'pointer',
                                        fontSize: '14px',
                                        fontWeight: '500',
                                        color: 'var(--error)',
                                        borderRadius: '0 0 12px 12px',
                                        transition: 'all 0.2s',
                                        fontFamily: 'Lato, sans-serif'
                                    }}
                                    onMouseEnter={(e) => e.target.style.background = 'var(--gray-50)'}
                                    onMouseLeave={(e) => e.target.style.background = 'none'}
                                >
                                    Archive
                                </button>
                            </div>
                        )}
                    </div>

                    {showDuplicateModal && (
                        <DuplicateModal
                            agent={agent}
                            onClose={() => setShowDuplicateModal(false)}
                        />
                    )}
                </>
            );
        };

        // ============================================
        // DUPLICATE MODAL
        // ============================================
        const DuplicateModal = ({ agent, onClose }) => {
            const { duplicateAgent, setCurrentAgent, setWizardStep, setView } = useApp();
            const [newName, setNewName] = useState(`${agent.name} (Copy)`);
            const [newChannel, setNewChannel] = useState(agent.channel);

            const handleDuplicate = () => {
                const duplicated = duplicateAgent(agent, newName, newChannel);
                setCurrentAgent(duplicated);
                setWizardStep(0);
                setView('wizard');
                onClose();
            };

            return (
                <div style={{
                    position: 'fixed',
                    inset: 0,
                    background: 'rgba(0, 0, 0, 0.5)',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    zIndex: 100,
                    padding: '20px'
                }}
                onClick={onClose}>
                    <div
                        className="card"
                        style={{
                            width: '100%',
                            maxWidth: '600px',
                            padding: '32px',
                            maxHeight: '90vh',
                            overflowY: 'auto'
                        }}
                        onClick={(e) => e.stopPropagation()}
                    >
                        <h2 style={{ fontSize: '28px', fontWeight: '700', color: 'var(--gray-900)', marginBottom: '24px' }}>
                            Duplicate Agent
                        </h2>

                        <div style={{
                            padding: '20px',
                            background: 'var(--gray-50)',
                            borderRadius: '12px',
                            marginBottom: '24px'
                        }}>
                            <div style={{ fontSize: '13px', color: 'var(--gray-600)', marginBottom: '8px', fontWeight: '600' }}>
                                Duplicating from:
                            </div>
                            <div style={{ fontSize: '18px', fontWeight: '700', color: 'var(--gray-900)' }}>
                                {agent.name}
                            </div>
                            <div style={{ fontSize: '14px', color: 'var(--gray-600)', marginTop: '4px' }}>
                                Channel: <span style={{ textTransform: 'capitalize', fontWeight: '600' }}>{agent.channel}</span>
                            </div>
                        </div>

                        <div style={{ marginBottom: '24px' }}>
                            <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: 'var(--gray-900)', marginBottom: '8px' }}>
                                New Agent Name
                            </label>
                            <input
                                type="text"
                                value={newName}
                                onChange={(e) => setNewName(e.target.value)}
                                className="input"
                                placeholder="Enter new agent name"
                            />
                        </div>

                        <div style={{ marginBottom: '24px' }}>
                            <label style={{ display: 'block', fontSize: '14px', fontWeight: '600', color: 'var(--gray-900)', marginBottom: '8px' }}>
                                Change Channel (Optional)
                            </label>
                            <select
                                value={newChannel}
                                onChange={(e) => setNewChannel(e.target.value)}
                                className="input"
                            >
                                <option value={agent.channel}>Same as original ({agent.channel})</option>
                                <option value="voice">Voice</option>
                                <option value="whatsapp">WhatsApp</option>
                                <option value="sms">SMS</option>
                                <option value="email">Email</option>
                            </select>
                            {newChannel !== agent.channel && (
                                <div style={{
                                    marginTop: '12px',
                                    padding: '12px 16px',
                                    background: 'rgba(255, 149, 0, 0.1)',
                                    border: '1px solid var(--warning)',
                                    borderRadius: '8px',
                                    fontSize: '14px',
                                    color: 'var(--warning)'
                                }}>
                                    ⚠️ Changing channels may require you to review and adjust some settings
                                </div>
                            )}
                        </div>

                        <div style={{
                            padding: '20px',
                            background: 'var(--lavender-light)',
                            borderRadius: '12px',
                            marginBottom: '24px'
                        }}>
                            <div style={{ fontSize: '14px', fontWeight: '700', color: 'var(--gray-900)', marginBottom: '12px' }}>
                                What gets copied:
                            </div>
                            <div style={{ fontSize: '14px', color: 'var(--gray-700)', lineHeight: '1.8' }}>
                                <div>✓ User Selection</div>
                                <div>✓ Knowledge Bases (if compatible)</div>
                                <div>✓ Configuration (if compatible)</div>
                                <div>✓ Prompt (flagged for review if channel changed)</div>
                                <div>✓ Document Template</div>
                                <div style={{ color: 'var(--error)' }}>✗ Triggers (you'll configure these)</div>
                            </div>
                        </div>

                        <div style={{ display: 'flex', gap: '12px' }}>
                            <button onClick={onClose} className="btn btn-secondary" style={{ flex: 1 }}>
                                Cancel
                            </button>
                            <button
                                onClick={handleDuplicate}
                                disabled={!newName.trim()}
                                className="btn btn-primary"
                                style={{ flex: 1 }}
                            >
                                Create Duplicate
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // ============================================
        // AGENT WIZARD (Placeholder for now)
        // ============================================
        const AgentWizard = () => {
            return (
                <div style={{ maxWidth: '1600px', margin: '0 auto', padding: '40px 32px' }}>
                    <div className="card" style={{ padding: '80px 40px', textAlign: 'center' }}>
                        <div style={{
                            width: '80px',
                            height: '80px',
                            background: 'var(--purple-ultralight)',
                            borderRadius: '20px',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            margin: '0 auto 24px',
                            color: 'var(--purple-brand)'
                        }}>
                            <Icon name="settings" className="w-10 h-10" />
                        </div>
                        <h2 style={{ fontSize: '28px', fontWeight: '700', color: 'var(--gray-900)', marginBottom: '12px' }}>
                            Wizard Coming Soon
                        </h2>
                        <p style={{ fontSize: '16px', color: 'var(--gray-600)', marginBottom: '24px' }}>
                            The 9-step agent creation wizard is being built. For now, enjoy the agent list view!
                        </p>
                    </div>
                </div>
            );
        };

        // ============================================
        // RENDER APP
        // ============================================
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <AppProvider>
                <App />
            </AppProvider>
        );
    </script>
</body>
</html>